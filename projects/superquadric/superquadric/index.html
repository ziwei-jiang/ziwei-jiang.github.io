<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Extended Superquadric | Ziwei's Site</title><meta name=keywords content="Computer Vision"><meta name=description content="A brief introduction to extended superquadrics."><meta name=author content><link rel=canonical href=https://ziwei-jiang.github.io/projects/superquadric/superquadric/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.175f8a2522675f2652eb58ad47be19952cb91de9e66edc4b95bb19fff5546ef5.css integrity="sha256-F1+KJSJnXyZS61itR74ZlSy5HenmbtxLlbsZ//VUbvU=" rel="preload stylesheet" as=style><link rel=icon href=https://ziwei-jiang.github.io/img/abra_icon.png><link rel=icon type=image/png sizes=16x16 href=https://ziwei-jiang.github.io/img/abra_icon.png><link rel=icon type=image/png sizes=32x32 href=https://ziwei-jiang.github.io/img/abra_icon.png><link rel=apple-touch-icon href=https://ziwei-jiang.github.io/img/abra_icon.png><link rel=mask-icon href=https://ziwei-jiang.github.io/img/abra_icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://ziwei-jiang.github.io/projects/superquadric/superquadric/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.css integrity=sha384-bYdxxUwYipFNohQlHt0bjN/LCpueqWz13HufFEV1SUatKs1cm4L6fFgCi1jT643X crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.js integrity=sha384-Qsn9KnoKISj6dI8g7p1HBlNpVx0I8p1SvlwOldgi3IorMle61nQy4zEahWYtljaz crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-H4P7KF2N8Z"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-H4P7KF2N8Z")}</script><meta property="og:url" content="https://ziwei-jiang.github.io/projects/superquadric/superquadric/"><meta property="og:site_name" content="Ziwei's Site"><meta property="og:title" content="Extended Superquadric"><meta property="og:description" content="A brief introduction to extended superquadrics."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="projects"><meta property="article:published_time" content="2022-02-07T03:14:03-05:00"><meta property="article:modified_time" content="2022-02-07T03:14:03-05:00"><meta property="article:tag" content="Computer Vision"><meta property="og:image" content="https://ziwei-jiang.github.io/projects/superquadric/superquadric/projects/superquadric/cover.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://ziwei-jiang.github.io/projects/superquadric/superquadric/projects/superquadric/cover.png"><meta name=twitter:title content="Extended Superquadric"><meta name=twitter:description content="A brief introduction to extended superquadrics."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Projects","item":"https://ziwei-jiang.github.io/projects/"},{"@type":"ListItem","position":2,"name":"Extended Superquadric","item":"https://ziwei-jiang.github.io/projects/superquadric/superquadric/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Extended Superquadric","name":"Extended Superquadric","description":"A brief introduction to extended superquadrics.","keywords":["Computer Vision"],"articleBody":"Superquadric modeling was my first project in grad school, back when there were not as many 3D modeling techniques available as there are today. Using parametric models to describe 3D shapes has several advantages. First, this is a robust and efficient way to represent and recover 3D models for applications like large-scale building modeling. Second, the parametric model provides a natural way to describe shapes as primitives for applications such as point cloud segmentation and robot grasping. We used a variation called extended superquadric by Lin and Kambhamettu (2001) for the project. It involves some concepts in computational graphics, one without such background might need some time to grasp the idea. So I hope this post could be helpful as introductory material summarizing key points about the extended superquadric.\nSuperquadrics Superquadric was introduced by Alan Barr in 1981. It is defined as a family of shapes, including superellipsoid and supertoroids. In most of the existing literature, “superquadrics” refer to superellipsoids since those are the most representative shapes in applications. The superquadric is defined by the following equation. $$\\left(\\left|\\frac{x}{a_1}\\right|^{\\frac{2}{\\epsilon_2}}+ \\left|\\frac{y}{a_2}\\right|^\\frac{2}{\\epsilon_2}\\right)^\\frac{\\epsilon_2}{\\epsilon_1}+\\left|\\frac{z}{a_3}\\right|^\\frac{2}{\\epsilon_1}=1$$ Where the $a_1$, $a_2$, and $a_3$ are the scale factor in the $x$, $y$, and $z$ directions, $\\epsilon_1$ and $\\epsilon_2$ control the squareness in the vertical axis and x-y plane, respectively. This is also known as the inside-outside function since it shows the relationship between any point and the surface. The set of superquadrics is shown in the figure. Superquadrics The best way to understand the superquadric equation intuitively is to express it as a spherical product of two superellipses.\nThe superellipse, also known as Lame curves, named after French mathematician Gabriel Lame, was discovered long before the popularization of superquadrics. The superellipse is defined by the following equation. $$\\left(\\frac{x}{a_1}\\right)^\\frac{2}{\\epsilon} +\\left(\\frac{y}{a_2}\\right)^\\frac{2}{\\epsilon} =1$$\nSimilar to superquadrics, $a_1$ and $a_2$ are the scale factors and $\\epsilon$ is the squareness of the shape. Superellipse Parametric Form of Superquadrics The spherical product is defined as an operation of two 2D curves. For the 2D curve $h(\\omega)$ and $m(\\eta)$, the spherical product is given as follows. $$ h(\\omega) = \\begin{bmatrix}h_1(\\omega) \\\\ h_2(\\omega) \\end{bmatrix},\\quad \\omega_0 \\leq \\omega \\leq \\omega_1 $$ $$ m(\\eta) = \\begin{bmatrix}m_1(\\eta) \\\\ m_2(\\eta) \\end{bmatrix},\\quad \\eta_0 \\leq \\eta \\leq \\eta_1 $$ $$ x(\\eta,\\omega)= h(\\omega) \\otimes m(\\eta) = \\begin{bmatrix} m_1(\\eta) h_1(\\omega)\\\\ m_1(\\eta) h_2(\\omega)\\\\ m_2(\\eta) \\end{bmatrix}$$\nThe most common example of a spherical product is that for a sphere for which the spherical product involves a circle in the x-y plane and a half circle perpendicular to it. We use $\\phi$ for elevation and $\\theta$ for azimuth.\n$$m(\\phi) = \\begin{bmatrix}\\cos\\phi\\\\ \\sin\\phi \\end{bmatrix} ,\\quad-\\frac{\\pi}{2}\\leq\\phi\\leq \\frac{\\pi}{2}$$ $$h(\\theta) = \\begin{bmatrix}\\cos\\theta \\\\ \\sin\\theta \\end{bmatrix},\\quad-\\pi\\leq \\theta\\leq\\pi$$ $$r(\\phi,\\theta) = m(\\phi)\\otimes h(\\theta) = \\begin{bmatrix}x\\\\y\\\\z\\end{bmatrix} = \\begin{bmatrix} \\cos\\phi\\cos\\theta\\\\ \\cos\\phi\\sin\\theta\\\\ \\sin\\phi \\end{bmatrix}$$\nThe superquadric is formed by the spherical product of two superellipses. $$m(\\phi) = \\begin{bmatrix}sign(\\cos\\phi)\\left|\\cos\\phi\\right|^{\\epsilon_1} \\\\ a_3 sign(\\sin\\phi) \\left|\\sin\\phi\\right|^{\\epsilon_1} \\end{bmatrix},\\quad-\\frac{\\pi}{2}\\leq\\phi\\leq \\frac{\\pi}{2}$$ $$h(\\theta) = \\begin{bmatrix}a_1 sign(\\cos\\theta)\\left|\\cos\\theta\\right|^{\\epsilon_2} \\\\ a_2 sign(\\sin\\theta)\\left|\\sin\\theta\\right|^{\\epsilon_2} \\end{bmatrix},\\quad-\\pi\\leq\\theta\\leq \\pi $$ $$r(\\phi,\\theta) = m(\\phi)\\otimes h(\\theta) = \\begin{bmatrix}x\\\\y\\\\z\\end{bmatrix} = \\begin{bmatrix} a_1 sign(\\cos\\phi\\cos\\theta)\\left|\\cos\\phi\\right|^{\\epsilon_1} \\left|\\cos\\theta\\right|^{\\epsilon_2} \\\\ a_2 sign(\\cos\\phi\\sin\\theta)\\left|\\cos\\phi\\right|^{\\epsilon_1} \\left|\\sin\\theta\\right|^{\\epsilon_2} \\\\ a_3 sign(\\sin\\phi) \\left|\\sin\\phi\\right|^{\\epsilon_1} \\end{bmatrix}$$ This is the parametric form of the superquadric, which is useful for rendering the shape. We can think of $h(\\theta)$ as the curve on the x-y plane and it swept vertically according to the scale $m_1(\\phi)$ and vertical sweeping motion $m_2(\\phi)$. Similarly, it can auto be thought of as the curve perpendicular to the x-y plane sweeping around the z-axis according to $h(\\theta)$ as shown in the following figure. Spherical Product Derivation of Inside-outside Function We can derive the inside-outside function from the parametric function above. First square both side of equation, and get $$\\begin{bmatrix}x^2\\\\y^2\\\\z^2\\end{bmatrix} = \\begin{bmatrix} a_1^2 \\left|\\cos\\phi\\right|^{2\\epsilon_1} \\left|\\cos\\theta\\right|^{2\\epsilon_2} \\\\ a_2^2 \\left|\\cos\\phi\\right|^{2\\epsilon_1} \\left|\\sin\\theta\\right|^{2\\epsilon_2} \\\\ a_3^2 \\left|\\sin\\phi\\right|^{2\\epsilon_2} \\end{bmatrix}.$$\nThen move the scaler terms to the LHS $$\\begin{bmatrix}(\\frac{x}{a_1})^2\\\\(\\frac{y}{a_2})^2\\\\(\\frac{z}{a_3})^2\\end{bmatrix} = \\begin{bmatrix} \\left|\\cos\\phi\\right|^{2\\epsilon_1} \\left|\\cos\\theta\\right|^{2\\epsilon_2} \\\\ \\left|\\cos\\phi\\right|^{2\\epsilon_1} \\left|\\sin\\theta\\right|^{2\\epsilon_2} \\\\ \\left|\\sin\\phi\\right|^{2\\epsilon_1} \\end{bmatrix}$$\nThen raise the first two rows to the power of $\\frac{1}{\\epsilon_2}$ then sum the two rows. $$\\left(\\frac{x}{a_1}\\right)^\\frac{2}{\\epsilon_2}+\\left(\\frac{y}{a_2}\\right)^\\frac{2}{\\epsilon_2} = \\left|\\cos\\phi\\right|^\\frac{2\\epsilon_1}{\\epsilon_2}$$ Raise the equation to the power of $\\frac{\\epsilon_2}{\\epsilon_1}$, get: $$\\left(\\left(\\frac{x}{a_1}\\right)^\\frac{2}{\\epsilon_2}+\\left(\\frac{y}{a_2}\\right)^\\frac{2}{\\epsilon_2}\\right)^\\frac{\\epsilon_2}{\\epsilon_1} = \\left|\\cos\\phi\\right|^2$$\nThen raise the third row to the power of $\\frac{1}{\\epsilon_1}$. $$ \\left(\\frac{z}{a_3}\\right)^\\frac{2}{\\epsilon_1}= \\left|\\sin\\phi\\right|^{2}$$\nFinally, add the above two equations to get the inside-outside function. $$\\left(\\left(\\frac{x}{a_1}\\right)^\\frac{2}{\\epsilon_2}+\\left(\\frac{y}{a_2}\\right)^\\frac{2}{\\epsilon_2}\\right)^\\frac{\\epsilon_2}{\\epsilon_1} + \\left(\\frac{z}{a_3}\\right)^\\frac{2}{\\epsilon_1} = 1$$\nExtended Superquadrics The limitation of superquadrics lies in its symmetry property, which can be seen from its parametric form. To address this limitation, Zhou introduced the concept of an extended superquadric. Recall that the shape of a superquadric is determined by its exponents $\\epsilon_1$ and $\\epsilon_2$. We can create an asymmetric for the superquadric by breaking it into different sections with different exponents. The extended superquadric achieves this by using a function as the exponent instead of a constant. Zhou proposed using a Bézier curve as the exponent in his paper.\nBézier Curve There is a wonderful tutorial about the Bézier curve by Pomax. It provides a comprehensive introduction and interactive tools for the Bézier curve. Here I will briefly discuss the parts that are relevant to extended superquadrics. The following polynomial specifies the Bézier Curve of degree n function. $$ f(t) = \\sum_{i=0}^n P_{i}B_i^n(t)$$ $B_i^n(t) = {n\\choose i} t^i(1-t)^{n-i}$ is the Bernstein polynomial of degree $n$. The degree of the polynomial is determined by the number of control points used. Each control point is specified by its $(x,y)$ coordinates in the $(x,y)$-plane. For an $n^{th}$ degree Bézier curve, there are a total of $n+1$ control points.\nFor each value of $0\\leq t\\leq 1$, the Bernstein polynomial adds up to 1, $\\sum_i^n B_i^n(t) = 1$. So the Bézier curve can be interpreted as a weighted sum of the control points $P_i$, where the weights vary as $t$ ranges from zero to one. This is the key property that is used to control the shape of the extended superquadric.\nBézier Curves As Used in Extended Superquadrics The extended superquadric is defined by the following inside-outside function $$ \\left(\\left|\\frac{x}{a_1}\\right|^{\\frac{2}{f_2(\\theta)}}+ \\left|\\frac{y}{a_2}\\right|^\\frac{2}{f_2(\\theta)}\\right)^\\frac{f_2(\\theta)}{f_1(\\phi)}+\\left|\\frac{z}{a_3}\\right|^\\frac{2}{f_1(\\phi)}=1. $$\nThe two Bézier curves used are given by $$ f_1(\\phi) = \\sum_{i=0}^nP_{1,i}{n\\choose i} t^i (1-t)^{n-i},\\qquad t = \\frac{\\phi + \\frac{\\pi}{2}}{\\pi} ,$$ $$ f_2(\\theta) = \\sum_{i=0}^nP_{2,i}{n\\choose i} t^i (1-t)^{n-i},\\qquad t = \\frac{\\theta + \\pi}{2\\pi} ,$$ where $$ \\phi = \\arctan\\frac{z}{\\sqrt{x^2+y^2}}, $$ $$ \\theta = \\arctan(\\frac{y}{x}). $$\nThe range of values for the azimuth angle $\\theta$ is from $-\\pi$ to $\\pi$, while the range of values for the elevation angle $\\phi$ is from $-\\frac{\\pi}{2}$ to $\\frac{\\pi}{2}$. To satisfy the definition of a Bézier curve, the parameter $t$ for both curves is normalized to the range between zero and one.\nControl the Shapes with Bézier Curve In the previous section, we talked about how the value of a Bézier curve at any given $t$ is determined by a weighted combination of control points. If the control points are identical, the extended superquadric simplifies to an ordinary superquadric, indicating that the extended version is a more generalized form of the superquadric. The shape of the superquadric is determined by the first and last control points at t=0 and t=1, where they are assigned a weight of 1. As the weights depend on $t$, and the control points remain constant, employing more control points results in increased flexibility and variability in the superquadric.\nBézier curve with two control points When there are only two control points, we can create an asymmetric shape by assigning different values to each control point. However, once we have determined the shape of the curve at t=0 and t=1, there is no freedom to vary the shape in other regions of the curve.\nBézier curve with three control points When there are three control points, we can vary the shape of the curve by adjusting the value of the third control point. The position and weights of the first and last control points still determine the shape of the curve at t=0 and t=1, but the middle control point allows us to adjust the shape of the superquadric between those points.\nBézier curve with ten control points Similarly, when there are more control points, such as ten, we can create a more finely detailed variation of the curve’s shape. The position and weights of the first and last control points will still determine the overall shape of the superquadric at t=0 and t=1, but the additional control points allow for more fine adjustments to the shape in the regions between them. The more control points there are, the greater the degree of control we have over the curve’s shape.\nAn instance of an extended superquadric is presented where all control points are assigned a value of 1, except for one control point of $f_1$. Consequently, the resulting shape resembles a sphere with alterations on the upper portion of the superquadric. The smoothness property of Bézier curves means that modifying a single control point also affects the surrounding area. One approach to address this issue is to use a piecewise Bézier curve, which consists of multiple Bézier curves with shared endpoints. Using a piecewise Bézier curve makes it possible to create local deformations without affecting the neighboring regions.\nThe following images show the deformation of the superquadric by using a piecewise Bézier curve.\nExample: BB8 Here is an example of an extended superquadric model. An untextured BB8 model that is composed of 6 extended superquadrics.\nA 3D model of BB-8 made by extended superquadrics Conclusion This post provides a brief introduction to the superquadric and extended superquadric. For a more in-depth study of the topic, please refer to Segmentation and Recovery of Superquadrics. The book discusses various aspects of superquadrics, including fitting them to data, segmenting complex shapes, and exploring different variations of superquadrics.\nsuperquadrics can still be a useful method in certain cases, particularly for shape abstraction. Recent works such as Superquadrics Revisited: Learning 3D Shape Parsing beyond Cuboids and Robust and Accurate Superquadric Recovery: a Probabilistic Approach have demonstrated the applicability of superquadrics in this context.\n","wordCount":"1619","inLanguage":"en","image":"https://ziwei-jiang.github.io/projects/superquadric/superquadric/projects/superquadric/cover.png","datePublished":"2022-02-07T03:14:03-05:00","dateModified":"2022-02-07T03:14:03-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://ziwei-jiang.github.io/projects/superquadric/superquadric/"},"publisher":{"@type":"Organization","name":"Ziwei's Site","logo":{"@type":"ImageObject","url":"https://ziwei-jiang.github.io/img/abra_icon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ziwei-jiang.github.io/ accesskey=h title="Ziwei Jiang 姜子维 (Alt + H)"><img src=https://ziwei-jiang.github.io/img/abra_icon.png alt aria-label=logo height=35>Ziwei Jiang 姜子维</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ziwei-jiang.github.io/about/ title=About><span>About</span></a></li><li><a href=https://ziwei-jiang.github.io/notes/ title=Notes><span>Notes</span></a></li><li><a href=https://ziwei-jiang.github.io/projects/ title=Projects><span>Projects</span></a></li><li><a href=https://ziwei-jiang.github.io/publications/ title=Publications><span>Publications</span></a></li><li><a href=https://ziwei-jiang.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Extended Superquadric</h1><div class=post-description>A brief introduction to extended superquadrics.</div><div class=post-meta><span title='2022-02-07 03:14:03 -0500 EST'>February 7, 2022</span>&nbsp;·&nbsp;&nbsp;·&nbsp;<a href=/tags/computer-vision> Computer Vision</a></div></header><figure class=entry-cover1><img loading=lazy src=https://ziwei-jiang.github.io/projects/superquadric/cover.png alt><p></p></figure><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#superquadrics aria-label=Superquadrics>Superquadrics</a><ul><li><a href=#parametric-form-of-superquadrics aria-label="Parametric Form of Superquadrics">Parametric Form of Superquadrics</a></li><li><a href=#derivation-of-inside-outside-function aria-label="Derivation of Inside-outside Function">Derivation of Inside-outside Function</a></li></ul></li><li><a href=#extended-superquadrics aria-label="Extended Superquadrics">Extended Superquadrics</a><ul><li><a href=#b%c3%a9zier-curve aria-label="Bézier Curve">Bézier Curve</a></li><li><a href=#b%c3%a9zier-curves-as-used-in-extended-superquadrics aria-label="Bézier Curves As Used in Extended Superquadrics">Bézier Curves As Used in Extended Superquadrics</a></li><li><a href=#control-the-shapes-with-b%c3%a9zier-curve aria-label="Control the Shapes with Bézier Curve">Control the Shapes with Bézier Curve</a></li><li><a href=#example-bb8 aria-label="Example: BB8">Example: BB8</a></li></ul></li><li><a href=#conclusion aria-label=Conclusion>Conclusion</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>Superquadric modeling was my first project in grad school, back when there were not as many 3D modeling techniques available as there are today. Using parametric models to describe 3D shapes has several advantages. First, this is a robust and efficient way to represent and recover 3D models for applications like large-scale building modeling. Second, the parametric model provides a natural way to describe shapes as primitives for applications such as point cloud segmentation and robot grasping.
We used a variation called extended superquadric by <a href="https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=fed4a22266c2da42c12b2c8cbd2512e6735531f0">Lin and Kambhamettu (2001)</a> for the project.
It involves some concepts in computational graphics, one without such background might need some time to grasp the idea. So I hope this post could be helpful as introductory material summarizing key points about the extended superquadric.</p><h1 id=superquadrics>Superquadrics<a hidden class=anchor aria-hidden=true href=#superquadrics>#</a></h1><p>Superquadric was introduced by Alan Barr in 1981. It is defined as a family of shapes, including superellipsoid and supertoroids. In most of the existing literature, &ldquo;superquadrics&rdquo; refer to superellipsoids since those are the most representative shapes in applications.
The superquadric is defined by the following equation.
$$\left(\left|\frac{x}{a_1}\right|^{\frac{2}{\epsilon_2}}+ \left|\frac{y}{a_2}\right|^\frac{2}{\epsilon_2}\right)^\frac{\epsilon_2}{\epsilon_1}+\left|\frac{z}{a_3}\right|^\frac{2}{\epsilon_1}=1$$
Where the $a_1$, $a_2$, and $a_3$ are the scale factor in the $x$, $y$, and $z$ directions, $\epsilon_1$ and $\epsilon_2$ control the squareness in the vertical axis and x-y plane, respectively. This is also known as the <strong>inside-outside function</strong> since it shows the relationship between any point and the surface. The set of superquadrics is shown in the figure.<figure class=align-center><img loading=lazy src=/projects/superquadric/superquadrics_photos.png#center width=100%><figcaption>Superquadrics</figcaption></figure>The best way to understand the superquadric equation intuitively is to express it as a spherical product of two superellipses.</p><p>The <strong>superellipse</strong>, also known as Lame curves, named after French mathematician Gabriel Lame, was discovered long before the popularization of superquadrics. The superellipse is defined by the following equation.
$$\left(\frac{x}{a_1}\right)^\frac{2}{\epsilon} +\left(\frac{y}{a_2}\right)^\frac{2}{\epsilon} =1$$</p><p>Similar to superquadrics, $a_1$ and $a_2$ are the scale factors and $\epsilon$ is the squareness of the shape.<figure class=align-center><img loading=lazy src=/projects/superquadric/superellipse.png#center width=60%><figcaption>Superellipse</figcaption></figure></p><h2 id=parametric-form-of-superquadrics>Parametric Form of Superquadrics<a hidden class=anchor aria-hidden=true href=#parametric-form-of-superquadrics>#</a></h2><p>The spherical product is defined as an operation of two 2D curves. For the 2D curve $h(\omega)$ and $m(\eta)$, the spherical product is given as follows.
$$ h(\omega) = \begin{bmatrix}h_1(\omega) \\ h_2(\omega) \end{bmatrix},\quad \omega_0 \leq \omega \leq \omega_1 $$
$$ m(\eta) = \begin{bmatrix}m_1(\eta) \\ m_2(\eta) \end{bmatrix},\quad \eta_0 \leq \eta \leq \eta_1 $$
$$ x(\eta,\omega)= h(\omega) \otimes m(\eta) =
\begin{bmatrix}
m_1(\eta) h_1(\omega)\\
m_1(\eta) h_2(\omega)\\
m_2(\eta)
\end{bmatrix}$$</p><p>The most common example of a spherical product is that for a sphere for
which the spherical product involves a circle in the x-y plane and a half circle perpendicular to it.
We use $\phi$ for elevation and $\theta$ for azimuth.</p><p>$$m(\phi) = \begin{bmatrix}\cos\phi\\ \sin\phi \end{bmatrix} ,\quad-\frac{\pi}{2}\leq\phi\leq \frac{\pi}{2}$$
$$h(\theta) = \begin{bmatrix}\cos\theta \\ \sin\theta \end{bmatrix},\quad-\pi\leq \theta\leq\pi$$
$$r(\phi,\theta) = m(\phi)\otimes h(\theta) = \begin{bmatrix}x\\y\\z\end{bmatrix} =
\begin{bmatrix}
\cos\phi\cos\theta\\
\cos\phi\sin\theta\\
\sin\phi
\end{bmatrix}$$</p><p>The superquadric is formed by the spherical product of two superellipses.
$$m(\phi) = \begin{bmatrix}sign(\cos\phi)\left|\cos\phi\right|^{\epsilon_1} \\ a_3 sign(\sin\phi) \left|\sin\phi\right|^{\epsilon_1} \end{bmatrix},\quad-\frac{\pi}{2}\leq\phi\leq \frac{\pi}{2}$$
$$h(\theta) = \begin{bmatrix}a_1 sign(\cos\theta)\left|\cos\theta\right|^{\epsilon_2} \\ a_2 sign(\sin\theta)\left|\sin\theta\right|^{\epsilon_2} \end{bmatrix},\quad-\pi\leq\theta\leq \pi $$
$$r(\phi,\theta) = m(\phi)\otimes h(\theta) = \begin{bmatrix}x\\y\\z\end{bmatrix} = \begin{bmatrix} a_1 sign(\cos\phi\cos\theta)\left|\cos\phi\right|^{\epsilon_1} \left|\cos\theta\right|^{\epsilon_2} \\
a_2 sign(\cos\phi\sin\theta)\left|\cos\phi\right|^{\epsilon_1} \left|\sin\theta\right|^{\epsilon_2} \\
a_3 sign(\sin\phi) \left|\sin\phi\right|^{\epsilon_1}
\end{bmatrix}$$
This is the <strong>parametric form</strong> of the superquadric, which is useful for rendering the shape.
We can think of $h(\theta)$ as the curve on the x-y plane and it swept vertically according to the scale $m_1(\phi)$ and vertical sweeping motion $m_2(\phi)$. Similarly, it can auto be thought of as the curve perpendicular to the x-y plane sweeping around the z-axis according to $h(\theta)$ as shown in the following figure.<figure class=align-center><img loading=lazy src=/projects/superquadric/spherical_product.gif#center width=60%><figcaption>Spherical Product</figcaption></figure></p><h2 id=derivation-of-inside-outside-function>Derivation of Inside-outside Function<a hidden class=anchor aria-hidden=true href=#derivation-of-inside-outside-function>#</a></h2><p>We can derive the inside-outside function from the parametric function above.
First square both side of equation, and get
$$\begin{bmatrix}x^2\\y^2\\z^2\end{bmatrix} = \begin{bmatrix} a_1^2 \left|\cos\phi\right|^{2\epsilon_1} \left|\cos\theta\right|^{2\epsilon_2} \\
a_2^2 \left|\cos\phi\right|^{2\epsilon_1} \left|\sin\theta\right|^{2\epsilon_2} \\
a_3^2 \left|\sin\phi\right|^{2\epsilon_2}
\end{bmatrix}.$$</p><p>Then move the scaler terms to the LHS
$$\begin{bmatrix}(\frac{x}{a_1})^2\\(\frac{y}{a_2})^2\\(\frac{z}{a_3})^2\end{bmatrix} = \begin{bmatrix} \left|\cos\phi\right|^{2\epsilon_1} \left|\cos\theta\right|^{2\epsilon_2} \\
\left|\cos\phi\right|^{2\epsilon_1} \left|\sin\theta\right|^{2\epsilon_2} \\
\left|\sin\phi\right|^{2\epsilon_1}
\end{bmatrix}$$</p><p>Then raise the first two rows to the power of $\frac{1}{\epsilon_2}$ then sum the two rows.
$$\left(\frac{x}{a_1}\right)^\frac{2}{\epsilon_2}+\left(\frac{y}{a_2}\right)^\frac{2}{\epsilon_2} = \left|\cos\phi\right|^\frac{2\epsilon_1}{\epsilon_2}$$
Raise the equation to the power of $\frac{\epsilon_2}{\epsilon_1}$, get:
$$\left(\left(\frac{x}{a_1}\right)^\frac{2}{\epsilon_2}+\left(\frac{y}{a_2}\right)^\frac{2}{\epsilon_2}\right)^\frac{\epsilon_2}{\epsilon_1} = \left|\cos\phi\right|^2$$</p><p>Then raise the third row to the power of $\frac{1}{\epsilon_1}$.
$$ \left(\frac{z}{a_3}\right)^\frac{2}{\epsilon_1}= \left|\sin\phi\right|^{2}$$</p><p>Finally, add the above two equations to get the inside-outside function.
$$\left(\left(\frac{x}{a_1}\right)^\frac{2}{\epsilon_2}+\left(\frac{y}{a_2}\right)^\frac{2}{\epsilon_2}\right)^\frac{\epsilon_2}{\epsilon_1} + \left(\frac{z}{a_3}\right)^\frac{2}{\epsilon_1} = 1$$</p><h1 id=extended-superquadrics>Extended Superquadrics<a hidden class=anchor aria-hidden=true href=#extended-superquadrics>#</a></h1><p>The limitation of superquadrics lies in its symmetry property, which can be seen from its parametric form. To address this limitation, Zhou introduced the concept of an extended superquadric. Recall that the shape of a superquadric is determined by its exponents $\epsilon_1$ and $\epsilon_2$. We can create an asymmetric for the superquadric by breaking it into different sections with different exponents. The extended superquadric achieves this by using a function as the exponent instead of a constant. Zhou proposed using a Bézier curve as the exponent in his paper.</p><h2 id=bézier-curve>Bézier Curve<a hidden class=anchor aria-hidden=true href=#bézier-curve>#</a></h2><p>There is a wonderful tutorial about the <a href=https://pomax.github.io/b%C3%A9zierinfo/><strong>Bézier curve</strong></a> by Pomax. It provides a comprehensive introduction and interactive tools for the Bézier curve. Here I will briefly discuss the parts that are relevant to extended superquadrics.
The following polynomial specifies the Bézier Curve of degree n function.
$$ f(t) = \sum_{i=0}^n P_{i}B_i^n(t)$$
$B_i^n(t) = {n\choose i} t^i(1-t)^{n-i}$ is the <a href=https://mathworld.wolfram.com/BernsteinPolynomial.html><strong>Bernstein polynomial</strong></a> of degree $n$. The degree of the polynomial is determined by the number of control points used. Each control point is specified by its $(x,y)$ coordinates in the $(x,y)$-plane.
For an $n^{th}$ degree Bézier curve, there are a total of $n+1$ control points.</p><p>For each value of $0\leq t\leq 1$, the Bernstein polynomial adds up to 1, $\sum_i^n B_i^n(t) = 1$. So the Bézier curve can be interpreted as a weighted sum of the control points $P_i$, where the weights vary as $t$ ranges from zero to one. This is the key property that is used to control the shape of the extended superquadric.</p><h2 id=bézier-curves-as-used-in-extended-superquadrics>Bézier Curves As Used in Extended Superquadrics<a hidden class=anchor aria-hidden=true href=#bézier-curves-as-used-in-extended-superquadrics>#</a></h2><p>The extended superquadric is defined by the following inside-outside function
$$ \left(\left|\frac{x}{a_1}\right|^{\frac{2}{f_2(\theta)}}+ \left|\frac{y}{a_2}\right|^\frac{2}{f_2(\theta)}\right)^\frac{f_2(\theta)}{f_1(\phi)}+\left|\frac{z}{a_3}\right|^\frac{2}{f_1(\phi)}=1. $$</p><p>The two Bézier curves used are given by
$$ f_1(\phi) = \sum_{i=0}^nP_{1,i}{n\choose i} t^i (1-t)^{n-i},\qquad t = \frac{\phi + \frac{\pi}{2}}{\pi} ,$$
$$ f_2(\theta) = \sum_{i=0}^nP_{2,i}{n\choose i} t^i (1-t)^{n-i},\qquad t = \frac{\theta + \pi}{2\pi} ,$$
where
$$ \phi = \arctan\frac{z}{\sqrt{x^2+y^2}}, $$
$$ \theta = \arctan(\frac{y}{x}). $$</p><p>The range of values for the azimuth angle $\theta$ is from $-\pi$ to $\pi$, while the range of values for the elevation angle $\phi$ is from $-\frac{\pi}{2}$ to $\frac{\pi}{2}$. To satisfy the definition of a Bézier curve, the parameter $t$ for both curves is normalized to the range between zero and one.</p><h2 id=control-the-shapes-with-bézier-curve>Control the Shapes with Bézier Curve<a hidden class=anchor aria-hidden=true href=#control-the-shapes-with-bézier-curve>#</a></h2><p>In the previous section, we talked about how the value of a Bézier curve at any given $t$ is determined by a weighted combination of control points. If the control points are identical, the extended superquadric simplifies to an ordinary superquadric, indicating that the extended version is a more generalized form of the superquadric. The shape of the superquadric is determined by the first and last control points at t=0 and t=1, where they are assigned a weight of 1. As the weights depend on $t$, and the control points remain constant, employing more control points results in increased flexibility and variability in the superquadric.</p><figure class=align-center><img loading=lazy src=/projects/superquadric/two_pts.png#center width=70%><figcaption>Bézier curve with two control points</figcaption></figure><p>When there are only two control points, we can create an asymmetric shape by assigning different values to each control point. However, once we have determined the shape of the curve at t=0 and t=1, there is no freedom to vary the shape in other regions of the curve.</p><figure class=align-center><img loading=lazy src=/projects/superquadric/three_pts.png#center width=70%><figcaption>Bézier curve with three control points</figcaption></figure><p>When there are three control points, we can vary the shape of the curve by adjusting the value of the third control point. The position and weights of the first and last control points still determine the shape of the curve at t=0 and t=1, but the middle control point allows us to adjust the shape of the superquadric between those points.</p><figure class=align-center><img loading=lazy src=/projects/superquadric/ten_pts.png#center width=70%><figcaption>Bézier curve with ten control points</figcaption></figure><p>Similarly, when there are more control points, such as ten, we can create a more finely detailed variation of the curve&rsquo;s shape. The position and weights of the first and last control points will still determine the overall shape of the superquadric at t=0 and t=1, but the additional control points allow for more fine adjustments to the shape in the regions between them. The more control points there are, the greater the degree of control we have over the curve&rsquo;s shape.</p><table><thead><tr><th style=text-align:center><img alt=ex-superquadric loading=lazy src=/projects/superquadric/ex1.png></th><th style=text-align:center><img alt=ex-superquadric-control loading=lazy src=/projects/superquadric/ex1_control.png></th></tr></thead><tbody></tbody></table><p>An instance of an extended superquadric is presented where all control points are assigned a value of 1, except for one control point of $f_1$. Consequently, the resulting shape resembles a sphere with alterations on the upper portion of the superquadric.
The smoothness property of Bézier curves means that modifying a single control point also affects the surrounding area. One approach to address this issue is to use a piecewise Bézier curve, which consists of multiple Bézier curves with shared endpoints. Using a piecewise Bézier curve makes it possible to create local deformations without affecting the neighboring regions.</p><table><thead><tr><th style=text-align:center><img alt=ex-superquadric loading=lazy src=/projects/superquadric/ex2.png></th><th style=text-align:center><img alt=ex-superquadric-control loading=lazy src=/projects/superquadric/ex2_control.png></th></tr></thead><tbody></tbody></table><p>The following images show the deformation of the superquadric by using a piecewise Bézier curve.</p><table><thead><tr><th style=text-align:center><img alt=ex-superquadric loading=lazy src=/projects/superquadric/ex3.gif></th><th style=text-align:center><img alt=ex-superquadric-control loading=lazy src=/projects/superquadric/ex3_control.gif></th></tr></thead><tbody></tbody></table><table><thead><tr><th style=text-align:center><img alt=ex-superquadric loading=lazy src=/projects/superquadric/ex4.gif></th><th style=text-align:center><img alt=ex-superquadric-control loading=lazy src=/projects/superquadric/ex4_control.gif></th></tr></thead><tbody></tbody></table><h2 id=example-bb8>Example: BB8<a hidden class=anchor aria-hidden=true href=#example-bb8>#</a></h2><p>Here is an example of an extended superquadric model. An untextured BB8 model that is composed of 6 extended superquadrics.</p><figure class=align-center><img loading=lazy src=/projects/superquadric/bb8.gif#center width=60%><figcaption>A 3D model of BB-8 made by extended superquadrics</figcaption></figure><h1 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h1><p>This post provides a brief introduction to the superquadric and extended superquadric. For a more in-depth study of the topic, please refer to <a href=https://link.springer.com/book/10.1007/978-94-015-9456-1>Segmentation and Recovery of Superquadrics</a>. The book discusses various aspects of superquadrics, including fitting them to data, segmenting complex shapes, and exploring different variations of superquadrics.</p><p>superquadrics can still be a useful method in certain cases, particularly for shape abstraction. Recent works such as <a href=https://openaccess.thecvf.com/content_CVPR_2019/papers/Paschalidou_Superquadrics_Revisited_Learning_3D_Shape_Parsing_Beyond_Cuboids_CVPR_2019_paper.pdf>Superquadrics Revisited: Learning 3D Shape Parsing beyond Cuboids</a> and <a href=https://openaccess.thecvf.com/content/CVPR2022/papers/Liu_Robust_and_Accurate_Superquadric_Recovery_A_Probabilistic_Approach_CVPR_2022_paper.pdf>Robust and Accurate Superquadric Recovery: a Probabilistic Approach</a> have demonstrated the applicability of superquadrics in this context.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://ziwei-jiang.github.io/tags/computer-vision/>Computer Vision</a></li></ul><nav class=paginav><a class=prev href=https://ziwei-jiang.github.io/projects/causal_effect_under_weak_confounding/weak_confounding/><span class=title>« Prev</span><br><span>Approximate Causal Effect Identification under Weak Confounding</span>
</a><a class=next href=https://ziwei-jiang.github.io/projects/robotics_specialization/estimation_learning/><span class=title>Next »</span><br><span>Robotics Specialization: Estimation and Learning</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://ziwei-jiang.github.io/>Ziwei's Site</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>